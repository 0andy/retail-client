<div class="alain-default__content-title" style="margin-bottom:0px;">
    <h1>
        {{hTitle}}
        <small>{{smallTitle}}</small>
    </h1>
</div>
<div nz-row class="mb-md" style="margin-top:10px;">
    <div nz-col nzSpan="5">
        <div nz-row>
            <div nz-col nzSpan="24">
                <div *ngIf="nodes && nodes.length > 0">
                    <nz-tree #treeCom [nzData]="nodes" nzMultiple="true" (nzClick)="activeNode($event)" [nzSearchValue]="searchName" (nzSearchValueChange)="nzEvent($event)" (nzDblClick)="openFolder($event)">
                        <ng-template #nzTreeTemplate let-node>
                            <span class="custom-node" [class.active]="activedNode?.key===node.key">
                                <span *ngIf="!node.isLeaf">
                                    <i class="anticon" (click)="openFolder(node)"></i>
                                    <span class="folder-name" [innerHTML]="node.title"></span>
                            </span>
                            <span *ngIf="node.isLeaf">
                                    <i class="anticon"></i>
                                    <span class="file-name" [innerHTML]="node.title"></span>
                            </span>
                            </span>
                        </ng-template>
                    </nz-tree>
                </div>
                <div *ngIf="!nodes || nodes.length == 0" style="width:100%; text-align:left; padding-top: 15px; padding-bottom: 15px; color: grey;">
                    没有分类数据，点击“添加分类”进行添加
                </div>
            </div>
        </div>
    </div>
    <div nz-col nzSpan="19">
        <div nz-row class="mb-md">
            <div nz-col nzSpan="18" style="padding-right:10px;">
                <nz-input-group nzSearch [nzSuffix]="suffixButton">
                    <input type="text" [(ngModel)]="keyWord" nz-input placeholder="商品条码、名称">
                </nz-input-group>
                <ng-template #suffixButton>
                    <button nz-button nzType="primary" [nzLoading]="isTableLoading" (click)="refreshData()" nzSearch>搜索</button>
                </ng-template>
            </div>
            <div nz-col nzSpan="6" style="text-align:right;">
                <button nz-button (click)="refreshData()" nzShape="circle" nz-tooltip nzPlacement="top" nzTitle="刷新">
                    <i class="anticon anticon-reload"></i>
                </button>
                <button nz-button *ngIf="!pageType" (click)="createProduct()" nzShape="circle" nzType="primary" nz-tooltip nzPlacement="top" nzTitle="新增">
                    <i class="anticon anticon-plus"></i>
                </button>
            </div>
        </div>
        <div nz-row>
            <div nz-col nzSpan="24">
                <ng-template #totalTemplate let-total>共 {{totalItems}} 条</ng-template>
                <nz-table #nzTable [nzData]="dataList" [nzFrontPagination]="false" [nzTotal]="totalItems" [nzShowTotal]="totalTemplate" [(nzPageIndex)]="pageNumber" [(nzPageSize)]="pageSize" [nzLoading]="isTableLoading" [nzShowSizeChanger]="true" (nzPageIndexChange)="refresh()"
                    (nzPageSizeChange)="refresh()">
                    <thead>
                        <tr>
                            <th>商品条码</th>
                            <th>商品名称</th>
                            <th>商品类型</th>
                            <th>单位</th>
                            <th *ngIf="pageType">库存</th>
                            <th *ngIf="!pageType">操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let data of nzTable.data">
                            <td>{{data.barCode}}</td>
                            <td>{{data.name}}</td>
                            <td>{{data.categoryName}}</td>
                            <td>{{data.unit}}</td>
                            <td *ngIf="pageType">
                                <a title="库存详情" style="text-decoration:underline;" (click)="goWaterDetail(data.barCode)">{{data.stock}}</a>
                            </td>
                            <td *ngIf="!pageType">
                                <a (click)="goDetail(data.id)">编辑</a>
                                <nz-divider nzType="vertical"></nz-divider>
                                <a (click)="updateStatus(data)" [ngClass]="{ 'true': data.isEnable== true }">{{data.isEnable?
                                    '禁用' : '启用'}}</a>
                            </td>
                        </tr>
                    </tbody>
                </nz-table>
            </div>
        </div>
    </div>
</div>
<app-product-confirm #createModal></app-product-confirm>